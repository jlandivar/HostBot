driver.execute_script("window.scrollTo(0, 0)")
driver.find_element(By.ID, "btnLista_calendario").click()
elementoPadre = driver.find_element(By.ID, "listaActividades")
listaDeElementos = elementoPadre.find_elements(By.XPATH, "div")
tabla = driver.find_element(By.ID, "diaActividadesAcordion_" + dia)

iDia = listaDeElementos.index(tabla)
dropDownBtn = elementoPadre.find_elements(By.XPATH, "h2")[iDia]
dropDownBtn.click()

botones = tabla.find_elements(By.XPATH, "table/tbody/tr/td[3]/button")

eliminados = 0

for i in regNumbers:
    cargandoX = True
    while cargandoX:
        try:
            botones[i].click()
            cargandoX = False
        except ElementNotInteractableException:
            print("noX")

    cargandoSi = True
    while cargandoSi:
        try:
            driver.find_element(By.XPATH, "/html/body/div/div/div/button/span").click()
            cargandoSi = False
        except Exception as e:
            print(type(e))
            print(e)
            if input("intentar otra vez?")!="":
                cargandoSi = False


    if len(tabla.find_elements(By.XPATH, "table/tbody/tr/td[3]/button")) == 1:
        tiempo = 0
    else:
        horas, mins = dropDownBtn.find_element(By.XPATH, "a/table/tbody/tr/td").text.split(" ")[5][1:].split(':')
        tiempo = (int(horas) + int(mins) / 60)

    window.calendario.tiempoPorDia[int(dia)] = tiempo
    date = window.calendario.dayNumberToDate(int(dia))
    window.calendario.updateCell(date)
    window.activityView.model().removeRow(i - eliminados)
    eliminados+=1


